(function(){function n(n){return document.getElementById(n)}function i(){n("enablefbct").className="hd";n("fbct").className="";t.style.display="none"}function s(t){for(var r,u,e=0;e!==t.length;++e)r=t[e],u=document.createElement("option"),u.value=r.deviceId,u.value===undefined&&(u.value=r.id),(r.kind==="video"||r.kind==="videoinput")&&(u.text=r.label||"camera "+(f.length+1),f.appendChild(u));t.length>0?n("html5videoarea").className="":i()}function u(){var t=n("camfail");t.textContent="Something went wrong. Try taking a picture using the button below instead.";t.style.display=""}function h(){var s,r,o;n("cameraeara").className="";s=f.value;r={video:{optional:[{sourceId:s}]}};navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(o=navigator.mediaDevices.getUserMedia(r),o.then(function(n){t.src=window.URL.createObjectURL(n);t.play();e()}),o["catch"](function(){u();i()})):navigator.getUserMedia?navigator.getUserMedia(r,function(n){t.src=n;t.play();e()},function(){i();u()}):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(r,function(n){t.src=window.webkitURL.createObjectURL(n);t.play();e()},function(){i();u()}):navigator.mozGetUserMedia?navigator.mozGetUserMedia(r,function(n){t.src=window.URL.createObjectURL(n);t.play();e()},function(){i();u()}):(i(),u())}function e(){setTimeout(function(){n("snapwait").style.display="none";n("cambtnsec").style.display=""},1e3)}var r=n("canvas"),t=n("video"),o,f;try{o=r.getContext("2d")}catch(c){i();return}f=n("videoSource");try{navigator.mediaDevices.enumerateDevices().then(s)["catch"](i)}catch(c){try{MediaStreamTrack.getSources(s)}catch(l){i()}}n("startcapture").addEventListener("click",function(n){h();n.preventDefault()});n("enh5ct").addEventListener("click",function(t){n("h5ct").className="";t.preventDefault()});n("enablefbct").addEventListener("click",function(t){n("fbct").className="";t.preventDefault()});n("enh5ct").style.display="";n("enablefbct").style.display="";n("snap").addEventListener("click",function(){var f=t.videoHeight,e=t.videoWidth,u;r.width=e;r.height=f;o.drawImage(t,0,0,e,f);t.style.display="none";r.style.display="";u=n("waitupload");u.style.display="";u.textContent="Wait while the picture is uploaded and analyzed.";var s=setInterval(function(){u.textContent=u.textContent+"."},350),h=r.toDataURL("image/jpeg",.5),i=new XMLHttpRequest;i.open("POST",this.dataset.uploadpath,!0);i.setRequestHeader("Content-Type","application/json; charset=UTF-8");i.send(h);i.onreadystatechange=function(){if(i.readyState===4){clearInterval(s);var t=n("uploadfail");i.status===200?(n("uploaddone").style.display="",t.style.display="none",n("waitupload").style.display="none",document.location.href=n("snap").dataset.returnpath):(t.style.display="",t.textContent=i.responseText,n("waitupload").style.display="none")}}})})(),function(){setTimeout(function(){var n=new XMLHttpRequest;n.open("GET","/api/prune?v="+Math.random());n.send(null);n.onreadystatechange=function(){var r,t,i;n.readyState===4&&n.status===200&&(r=document.getElementById("resetinfo"),r.innerHTML=n.responseText,t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src="/jsmin/lazy.min.js",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(t,i))}},1)}();jsfl=!0;