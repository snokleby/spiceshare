Date.now||(Date.now=function(){return(new Date).getTime()});var spiceGeo=function(){function n(n){return document.getElementById(n)}function f(){for(var t=document.querySelectorAll(".posfallback"),n=0;n<t.length;++n)t[n].className=""}function e(t,e){function l(){o.style.display="none";o.textContent="";clearInterval(c)}var s;if(i!==null&&r!==null&&u!==null&&(Date.now()-u)/1e3<120){n("lat").value=i;n("lon").value=r;s=n("locationaction");s!==null&&(s.style.display="");t();return}var h=!1,c=null,o=n("geowait");setTimeout(function(){h||(o.style.display="",o.textContent="Finding your location. Remember to accept if your device asks for permision to share your location.",c=setInterval(function(){o.textContent=o.textContent+"."},350))},300);navigator.geolocation.getCurrentPosition(function(f){h=!0;l();n("lat").value=f.coords.latitude;n("lon").value=f.coords.longitude;var e=n("locationaction");e!==null&&(e.style.display="");t();i=f.coords.latitude;r=f.coords.longitude;u=Date.now()},function(){l();n("geoerror").style.display="";f();e!==undefined&&e()},{enableHighAccuracy:!1,timeout:5e3,maximumAge:Infinity})}var t;"geolocation"in navigator?(t=n("jslocation"),t!==null&&t!==undefined&&(t.className="")):f();var i=null,r=null,u=null;return{GetGeoLocIntoFields:e}}();(function(){function n(){var t=document.getElementById("lat").value,i=document.getElementById("lon").value,r=document.getElementById("userid").value,n=new XMLHttpRequest;n.open("GET","/api/distanceToUser?id="+r+"&lat="+t+"&lon="+i,!0);n.send();n.onreadystatechange=function(){var t,i;n.readyState===4&&(t=document.getElementById("distajaxerr"),n.status===200?(document.getElementById("distancetext").style.display="",i=document.getElementById("distance"),i.textContent=n.responseText,i.style.display="",t.style.display="none"):(t.style.display="",t.textContent="Oops, we are unable to connect to the server. Check your internet-connection and try again."))}}document.getElementById("locationaction").addEventListener("click",function(t){n();t.preventDefault()});document.getElementById("updateuserloc").addEventListener("click",function(t){spiceGeo.GetGeoLocIntoFields(function(){n()});t.preventDefault()})})(),function(){setTimeout(function(){var n=new XMLHttpRequest;n.open("GET","/api/prune?v="+Math.random());n.send(null);n.onreadystatechange=function(){var r,t,i;n.readyState===4&&n.status===200&&(r=document.getElementById("resetinfo"),r.innerHTML=n.responseText,t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src="/jsmin/lazy.min.js",i=document.getElementsByTagName("script")[0],i.parentNode.insertBefore(t,i))}},1)}();jsfl=!0;